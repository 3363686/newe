Перечень типов товаров
по специфике их отображения в Каталоге и в Корзине

Попытался разобраться, отчего столько неясностей с доведением Корзины до рабочего состояния,
и систематизировал те ситуации, в которых отображение строки корзины сейчас непонятно или неправильно.
Выясняется, что таких ситуаций много, по причине разнообразия форматов отображения товаров.

Если считать, что представление информации на сайте сейчас оптимально
(а структура и состав БД и ПО сайта соответствуют именно такому варианту отображения),
то для правильной работы Корзины нужно существенно дополнить БД и скрипты самой Корзины.
Т.е. рассматриваем изменения, которые нужны только для Корзины и не затрагивают
работу Каталога и других станиц сайта.

Для не-штучных товаров, запись в Корзине "Количество: n" недостаточна для:
(а) понимания величины покупки, поэтому надо приписывать единицу измерения;
(б) (в некоторых случаях) расчета стоимости, которую надо умножать на коэффициент,
имеющий смысл "количество единиц цены в единице поставки".

Возможны такие варианты.

1. Товар, у которого единица цены не совпадает с единицей поставки.
Пример: Полиэтиленовая пленка, newe.ru/catalog/cat117.shtml.
Для описания его достаточно ввести значение из столбца "Единица поставки (в метрах)".
А для расчета цены умножить табличную цену на множитель "количество единиц цены в единице поставки"
(и потом на количество единиц покупки).

2. Товар, у которого также единица цены не совпадает с единицей поставки, но
соответствует цене единичного количества.
Пример: Гвозди строительные, newe.ru/catalog/cat14.shtml.
Для описания к кол-ву должно быть приписано "кг",
и для хранения этого "кг" должно быть заведено специальное свойство "Ед. изм.".
Это свойство не будет (в данном случае) выводиться на странице сайта (т.к. указано в шапке).

!!! Но с этим товаром имеется другая заморочка: заказать можно только к-во, кратное 5 (кг).
Должна ли корзина запрещать ввод некратных значений?
И как в таком случае работать: округлять до кратного в меньшую/большую сторону?
Тогда для такого товара придется добавлять свойство "Коэфф. квантования".

3. Товар, который продается только поштучно и это самоочевидно (большинство инструмента и т.п.).
4. Товар, который продается только упаковками и об этом указано в его названии.
Пример: Биты PHILLIPS, newe.ru/catalog/cat329.shtml.
Это единственные 2 случая, где все очевидно и ничего доделывать не надо.

5. Товар, который продается только упаковками и размер упаковки указан в шапке.
Пример: Биты шлиц, newe.ru/catalog/cat325.shtml.
Здесь придется либо одинаково дописывать размер упаковки в графу "Наименование" всех строк таблицы, замусоривая её,
либо добавлять специальное, не отображаемое на странице, свойство,
в котором хранить, в данном случае, текст "упак. 25 шт.".

6. Товар, который продается поштучно либо упаковками, размер которых указан в названии.
Пример: Свёрла по металлу удлинённые, newe.ru/catalog/cat417.shtml.
Здесь вопрос, однозначно ли будет понятно, что если "(уп. 2 шт.)" не написано, то это 1 шт.?

7. Товар, который продается только упаковками и размер упаковки указан в отдельном столбце.
Пример: Дюбели распорные с шипами, newe.ru/catalog/cat229.shtml.
Здесь, видимо, не избежать добавления специального свойства,
дублирующего этот столбец в текстовой форме "уп. 500 шт.".
Также здесь должен применяться коэффициент "количество единиц цены в единице поставки",
имеющий значение 1 или 0.5.

Резюме

Если число специфических вариантов отображения ограничивается перечисленными выше типами, то:

- Цена единицы товара (графа "Цена" Корзины) должна домножаться на коэффициент
"количество единиц цены в единице поставки", если у элемента задано это свойство.

- Поле "Единица измерения" (выводится в графе "Количество" Корзины) пусто либо
берется из свойства "Единица поставки", если у элемента оно задано.
Но сейчас такого свойства вообше в БД нет, но есть "Единица поставки (в метрах)".
Я считаю, что можно использовать это свойство: для некоторых товаров оно используется,
а для остальных, которым оно понадобится, будет добавлено для использования в Корзине только.

